<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>demo-co documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="./images/favicon.ico">
	    <link rel="stylesheet" href="./styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="./" class="navbar-brand">demo-co documentation</a>
            <button type="button" class="btn btn-default btn-menu fa fa-bars" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
            <div id="book-search-input" role="search">
                <input type="text" placeholder="Type to search">
            </div>
            <nav>
            
                <ul class="list">
            
                    <li class="title">
                        <a href="./">demo-co documentation</a>
                    </li>
            
                    <li class="divider"></li>
            
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="./"><span class="fa fa-home"></span>Getting started</a>
                        <ul class="links">
                                <li class="link">
                                    <a href="./"  class="active" ><span class="fa fa-file-text-o"></span>README</a>
                                </li>
                                <li class="link">
                                    <a  href="./overview.html" 
                                        
                                         href="./overview.html" 
                                        
                                        >
                                        <span class="fa fa-th"></span>Overview
                                    </a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="./modules.html" >
                            <span class="fa fa-archive"></span>
                            <span>Modules</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-modules-links"
                            ></span>
                        </a>
                        <ul class="links collapse in"
                                id="xs-modules-links"
                            >
                                <li class="link">
                                    <a href="modules/FormFieldsModule.html" >FormFieldsModule</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-cogs"></span>
                            <span>Components</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-components-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-components-links"
                            >
                                <li class="link">
                                    <a href="components/InputComponent.html" >InputComponent</a>
                                </li>
                        </ul>
                    </li>
            
            
            
            
            
            
            
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="./coverage.html" ><span class="fa fa-tasks"></span>Documentation coverage</a>
                    </li>
            
                    <li class="divider"></li>
                    <li class="copyright">
                            Documentation generated using <a href="https://compodoc.github.io/compodoc/" target="_blank">
                                        <img src=".//images/compodoc-vectorise.svg" class="img-responsive">
                            </a>
                    </li>
            
                </ul>
            
            </nav>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <nav>
                   
                       <ul class="list">
                   
                           <li class="title">
                               <a href="./">demo-co documentation</a>
                           </li>
                   
                           <li class="divider"></li>
                   
                               <div id="book-search-input" role="search">
                                   <input type="text" placeholder="Type to search">
                               </div>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="./"><span class="fa fa-home"></span>Getting started</a>
                               <ul class="links">
                                       <li class="link">
                                           <a href="./"  class="active" ><span class="fa fa-file-text-o"></span>README</a>
                                       </li>
                                       <li class="link">
                                           <a  href="./overview.html" 
                                               
                                                href="./overview.html" 
                                               
                                               >
                                               <span class="fa fa-th"></span>Overview
                                           </a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="./modules.html" >
                                   <span class="fa fa-archive"></span>
                                   <span>Modules</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#modules-links"
                                   ></span>
                               </a>
                               <ul class="links collapse in"
                                       id="modules-links"
                   >
                                       <li class="link">
                                           <a href="modules/FormFieldsModule.html" >FormFieldsModule</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-cogs"></span>
                                   <span>Components</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#components-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="components-links"
                   >
                                       <li class="link">
                                           <a href="components/InputComponent.html" >InputComponent</a>
                                       </li>
                               </ul>
                           </li>
                   
                   
                   
                   
                   
                   
                   
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="./coverage.html" ><span class="fa fa-tasks"></span>Documentation coverage</a>
                           </li>
                   
                           <li class="divider"></li>
                           <li class="copyright">
                                   Documentation generated using <a href="https://compodoc.github.io/compodoc/" target="_blank">
                                               <img src=".//images/compodoc-vectorise.svg" class="img-responsive">
                                   </a>
                           </li>
                   
                       </ul>
                   
                   </nav>
               </div>
               <div class="content readme">
                   <div class="content-data">
<h1 id="publishing-angular-libraries-with-nx">Publishing Angular Libraries with Nx</h1>
<p>How to build a group of interdependent publishable libraries all all namespaced under an NPM organization.</p>
<h2 id="https-github-com-nayfin-demo-co"><a href="https://github.com/nayfin/demo-co">https://github.com/nayfin/demo-co</a></h2>
<h2 id="what-is-nx-">What is Nx?</h2>
<p><a href="https://nx.dev/angular"><br>  <img width="200px" src="https://miro.medium.com/max/1281/0*44TVT2Pa3jrEkaXJ."/><br></a></p>
<p>Nx is a fantastic open-source tool for building monorepos built by the Nrwl team. Simplifies generation of Angular, React, and Nest apps and libraries. Find docs <a href="https://nx.dev/angular">here</a> and video tutorial <a href="https://nxplaybook.com/p/nx-workspaces">here</a>.</p>
<h2 id="what-is-an-npm-organization-">What is an NPM Organization?</h2>
<p><a href="https://npmjs.com"><br>  <img width="200px" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/Npm-logo.svg/330px-Npm-logo.svg.png"/><br></a></p>
<p>We can create an organization through npm and group all our libraries under this organization (e.g. @angular, @ngrx, @nrwl). This indicates to the consuming developer that the same organization created all your great libraries.</p>
<h2 id="why-create-libraries-">Why create libraries?</h2>
<p><img src="https://media.giphy.com/media/1iTpx5PpzRugcrZK/giphy.gif" alt="conchords" class="img-responsive"></p>
<p>Publishing libraries like this allows you to:</p>
<ul>
<li>easily reuse features you’ve built for other apps</li>
<li>share your code with anyone interested</li>
<li>enables others to contribute back to the project</li>
<li>show everyone (developers, companies, future employers) how great you are</li>
</ul>
<h2 id="why-use-nx-and-npm-organization-">Why use nx and npm organization?</h2>
<p>Libraries should be well organized and offer specific set of solutions (form fields, state management, ui features, layout). This keeps our libraries lightweight and prevents end-developers from having to download unused dependencies. Using Nx makes library publishing and deploying a trivial task and groups all libraries under a shared namespace.</p>
<h2 id="when-should-i-create-a-publishable-library-">When should I create a publishable library?</h2>
<p>Whenever you want access to the code you&#39;re writing outside the context you&#39;re writing it in (i.e. CLI project or Nx workspace).</p>
<h2 id="when-should-i-use-an-nx-workspace-over-something-like-ngneat-lib">When should I use an Nx Workspace over something like @ngneat/lib</h2>
<p>There are two main reasons to choose a workspace over a CLI generated library system:</p>
<ul>
<li>You are using the monorepo to organize projects and libraries and would also like to publish some of those libraries</li>
<li>You are building interdependent libraries and need to quickly how changes to one library effect the dependent libraries</li>
</ul>
<p>If you are only wanting to publish a single library, or multiple stand-alone libraries you should check out <a href="https://github.com/ngneat/lib">@ngneat/lib</a>. In addition to generating the publishable library, it generates templates for CODE_OF_CONDUCT.md, CONTRIBUTING.md, ISSUE_TEMPLATE.md, LICENSE.md, PULL_REQUEST_TEMPLATE.md, README.md. It also generates some scripts to help automate release.</p>
<h2 id="where-">Where?</h2>
<p>For our purposes, we are deploying to NPM as a public package, but you can easily follow similar steps to deploy to other public or private registries. Consult their docs for information on setup and publishing.</p>
<h2 id="how-do-we-do-all-this-">How do we do all this?</h2>
<p><img src="https://media.giphy.com/media/2xF8ihOYNJCG0iAXNU/giphy.gif" alt="thinking steven" class="img-responsive"></p>
<h3 id="1-create-npm-organization">1. Create NPM Organization</h3>
<ul>
<li><p>Register for an NPM account if you don&#39;t already have one <a href="https://www.npmjs.com/signup">here</a></p>
</li>
<li><p>Sign in through command line</p>
<p><code>npm login</code></p>
<p>Then follow prompts</p>
</li>
<li><p>Decide on a name for your workspace/organization. It&#39;s a good idea to make this short. It can be something non-descriptive (@mango) if you want to have disparate libraries, or something descriptive (@ngstate) if you want to have a group of related libraries.</p>
</li>
<li><p>Create an NPM Organization <a href="https://www.npmjs.com/org/create">here</a>. This will align with your Nx workspace name name allowing you to &quot;scope&quot; your libraries to one namespace. Do this before creating workspace to ensure that the organization name you want is available.</p>
</li>
</ul>
<h3 id="2-install-dependencies">2. Install Dependencies</h3>
<p>  <code>npm install -g @angular/cli</code></p>
<h3 id="3-generate-nx-workspace">3. Generate Nx Workspace</h3>
<p>  Use the npm organization from above as the namespace.</p>
<p>  <code>npx create-nx-workspace &lt;your-namespace&gt;</code></p>
<p>  Follow prompts:</p>
<ul>
<li>Pick the type of project (angular or angular-jest)</li>
<li>Pick style extension (scss is great!)</li>
<li>Name default app (<code>documentation</code> is usually a good bet)</li>
</ul>
<h3 id="4-create-library">4. Create Library</h3>
<p>  Each library should be focused on one feature (e.g. form-fields, state-management) and named appropriately.</p>
<p>  <code>ng generate @nrwl/angular:lib &lt;your-library-name&gt; --publishable</code></p>
<p>  Don&#39;t forget the <code>--publishable</code> at the end! It tells nx to do all the extra bits to make publishing easy.</p>
<ul>
<li><p>Generate First Library Component</p>
<p><code>ng generate component --project=&lt;your-library-name&gt;</code></p>
</li>
<li><p>Make it do something!</p>
</li>
</ul>
<h3 id="5-publish-library-once">5. Publish Library Once</h3>
<ul>
<li><p>commit changes</p>
<p><code>git commit -m &#39;Some changes on the master branch :)&#39;</code></p>
</li>
<li>set initial version in package.json</li>
<li><p>build library</p>
<p><code>ng build &lt;library-name&gt;</code></p>
</li>
<li><p>publish it!</p>
<p><code>cd dist/libs/&lt;library-name&gt; &amp;&amp; npm pack &amp;&amp; npm publish --access public &amp;&amp; cd ../../../</code></p>
</li>
</ul>
<h3 id="you-published-a-library-">You published a library!!</h3>
<p><img src="https://media.giphy.com/media/V2xbsCrxcLQSQ/giphy.gif" alt="jake prismo 5" class="img-responsive"></p>
<h2 id="6-automated-release-v1-">6. Automated Release (v1)</h2>
<p>  You published the library, awesome! But running all those commands manually was kind of gross. There are tools that can help, but for now there&#39;s a release script, <code>release.sh</code>, in the <code>scripts</code> folder.<br>  It automates release by:</p>
<ul>
<li>prompting user to input which package is being released</li>
<li>ensuring that we&#39;re on the master branch</li>
<li>prompting user to input version bump type (patch, minor, or major)</li>
<li>building, packaging, and publishing the library</li>
<li><p>committing a release commit after publishing</p>
<p>There are tons of other processes that could be added here (running tests), but it&#39;s a good start.</p>
<p>You can also add an npm run script to <code>package.json</code> if you&#39;d an alias.</p>
<pre><code class="hljs json">"scripts": {<br>  "release": "bash ./scripts/release.sh",<br>  ...<br>}</code></pre><p>There are a lot of ways to do this, and I am going to cover fancier options and important consideration when releasing interdependent packages in an upcoming talk.</p>
<p>You can also checkout implementing a CI/CD pipeline with Travis <a href="https://medium.com/@alfredo.perez.q/publish-angular-library-documentation-created-with-nx-using-travisci-and-github-pages-27854598239c">here</a>.</p>
</li>
</ul>
<h2 id="7-development-testbed-as-interactive-examples">7. Development Testbed as Interactive Examples</h2>
<p>  One of the most important pieces of a good library, is really good documentation. And if you plan the build and keep organized examples of the features as you build them out, then it&#39;s relatively easy to post your testbed as interactive documentation on <a href="https://stackblitz.com">StackBlitz</a></p>
<p>  StackBlitz can serve any Angular CLI generated project that is on a public github repo, pretty easily. Unfortunately, our documentation app was generated by Nx and StackBlitz can&#39;t serve it. So we have to do a little trickery to get it to work, but it&#39;s actually a good exercise as it forces us to user the library like our users are using it.</p>
<h3 id="steps">Steps</h3>
<ul>
<li>Organize the development testbed. I recommend each library as a lazy-loaded module with each feature as a routed component under that module. This will give you a place to test each feature, and will translate well as an example when it gets turned into docs.</li>
<li><p>Generate a Angular CLI project, named the same as your documentation app, in a directory next to your nx workspace</p>
<p><code>ng new &lt;your-documentation-app-name&gt;</code></p>
</li>
<li><p>Copy app from Nx workspace over to CLI project. From root of Nx workspace run:</p>
<p><code>cp -rf ./apps/&lt;docs-app-name&gt;/src/app ./../&lt;docs-app-name&gt;/src</code></p>
<h4 id="document-the-following-steps-in-readme-">DOCUMENT THE FOLLOWING STEPS IN README.</h4>
<p>This will probably be your first time using your package outside the context of the Nx workspace, and is a good opportunity to see what any consuming user will have to do to use your library. Make sure you carefully outline what it takes to get started with your library. If you have trouble getting it setup, imagine how hard it will be for anyone else to get started.</p>
</li>
<li><p>Add your package as well as any <code>peerDependencies</code> to the <code>package.json</code> of the CLI generated app.</p>
</li>
<li><p>Perform any other required setup (e.g. if you need Angular Material run <code>ng add @angular/material</code>).</p>
</li>
<li>Run documentation project<br><code>ng serve</code></li>
<li>Setup repo on github, commit and push changes to it.</li>
<li>View it on StackBlitz<br><code>https://stackblitz.com/github/&lt;your-github-username&gt;/&lt;your-project-name</code></li>
<li>Add above link to README.md file, now users can see exactly how to implement each feature of your library.</li>
</ul>
<h2 id="notes">Notes</h2>
<ul>
<li><p>Don&#39;t enable Ivy in libraries yet. View Engine (pre-Ivy) libraries are forwards compatible with Ivy apps but the reverse isn&#39;t true. Recommendation is to wait until Angular 10 before publishing Ivy libraries. The folks at Angular In Depth have a lot more advice <a href="https://indepth.dev/the-angular-ivy-guide-for-library-authors/">here</a>.</p>
</li>
<li><p>Update your library&#39;s <code>README.md</code> file, this will be displayed in on it&#39;s npm page. It should help users consuming your package to get started. <a href="https://medium.com/hackernoon/a-crash-course-on-writing-a-better-readme-d796d1f6b352">Here&#39;s</a> a good article on Medium help make it fancy, but at a minimum you&#39;ll want to have installation instructions and basic usage.</p>
</li>
<li><p>If your library consumes any packages (e.g. @angular/material, @angular/forms), be sure to add those packages to the <code>peerDependencies</code> in its <code>package.json</code> file, this will warn users if they are missing its dependencies.</p>
</li>
</ul>
<h2 id="resources">Resources</h2>
<ul>
<li><p>Alfredo Perez has a great series on publishing libraries with Nx. He even goes into implementing a CI/CD pipeline with Travis <a href="https://medium.com/@alfredo.perez.q/publish-angular-library-documentation-created-with-nx-using-travisci-and-github-pages-27854598239c">here</a>.</p>
</li>
<li><p>If you&#39;d like some help with your README, <a href="https://medium.com/hackernoon/a-crash-course-on-writing-a-better-readme-d796d1f6b352">here</a> is a good article on Medium by Adnan Rahić. Checkout <a href="www.shields.io">shields.io</a> if you&#39;d like to add some badges to your README.</p>
</li>
<li><p>If you&#39;d like to really dive deep, <a href="https://blog.angular.io/how-we-use-angular-at-the-gdf-cd17807a9bd2">here</a> is an article from the Angular Blog on building an <code>update</code> schematic to automatically fix breaking changes when you make them.</p>
</li>
</ul>
<h1 id="part-2">Part 2</h1>
<h2 id="automated-release-v2-">Automated Release (v2)</h2>
<p>  Scripts are good, but what if we had a system where, by adding a little detail to our commits, we can enable some pretty nice things:</p>
<blockquote>
<ul>
<li>Automatically generating CHANGELOGs.</li>
<li>Automatically determining a semantic version bump (based on the types of commits landed).</li>
<li>Communicating the nature of changes to teammates, the public, and other stakeholders.</li>
<li>Triggering build and publish processes.</li>
<li>Making it easier for people to contribute to your projects, by allowing them to explore a more structured commit history.  <br><br><cite> <a href="https://www.conventionalcommits.org/en/v1.0.0-beta.2/#why-use-conventional-commits">Conventional Commits</a> </cite></li>
</ul>
</blockquote>
<h3 id="1-let-s-start-with-the-commits">1. Let&#39;s start with the commits</h3>
<ul>
<li><p>install <code>commitizen</code> and <code>commitlint</code>, these will help us write more useful commit messages</p>
<p><code>npm i -D @commitlint/cli @commitlint/config-angular @commitlint/config-conventional git-cz</code></p>
</li>
<li><p>initialize commitizen and prepare repo</p>
<p><code>commitizen init cz-conventional-changelog --save-dev --save-exact</code></p>
</li>
<li><p>add an npm run script to <code>package.json</code></p>
<pre><code class="hljs json">  "scripts": {<br>    "commit": "git-cz",<br>    ...<br>  }</code></pre></li>
<li><p>run <code>npm run commit</code> and follow prompts, now it&#39;s easy to be diligent with our commits and they can become a lot more useful</p>
</li>
</ul>












                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
           </div>
       </div>

       <script src="./js/libs/bootstrap-native.js"></script>

       <script src="./js/libs/es6-shim.min.js"></script>
       <script src="./js/libs/EventDispatcher.js"></script>
       <script src="./js/libs/promise.min.js"></script>
       <script src="./js/libs/zepto.min.js"></script>

       <script src="./js/compodoc.js"></script>

       <script src="./js/search/search.js"></script>
       <script src="./js/search/lunr.min.js"></script>
       <script src="./js/search/search-lunr.js"></script>

       <script src="./js/menu.js"></script>
       <script src="./js/libs/highlight.pack.js"></script>
       <script src="./js/libs/highlightjs-line-numbers.min.js"></script>
       <script src="./js/search/search_index.js"></script>
       <script>
            document.addEventListener('DOMContentLoaded', function() {
                hljs.initHighlightingOnLoad();
                hljs.initLineNumbersOnLoad();
            });
       </script>

    </body>
</html>
